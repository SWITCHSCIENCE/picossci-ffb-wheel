package board

import (
	"machine"
	"time"
)

func Cmd(cmd byte) {
	LCD_RS.Low()
	LCD_CS.Low()
	machine.SPI1.Transfer(cmd)
	LCD_CS.High()
}

func Data(b []byte) {
	LCD_RS.High()
	LCD_CS.Low()
	dummy := make([]byte, len(b))
	machine.SPI1.Tx(b, dummy)
	LCD_CS.High()
}

func init() {
	LCD_RS.Configure(machine.PinConfig{Mode: machine.PinOutput})
	LCD_CS.Configure(machine.PinConfig{Mode: machine.PinOutput})
	LCD_CS.High()
	machine.SPI1.Configure(machine.SPIConfig{
		Mode: 3,
		SCK:  SPI1_SCK,
		SDO:  SPI1_TX,
		SDI:  SPI1_RX,
	})
	Cmd(0xae) // Display = OFF
	Cmd(0xa0) // ADC  normal
	Cmd(0xc8) // Reverse = OFF
	Cmd(0xa3) // LCD bias = 1/7
	//内部レギュレータON
	Cmd(0x2c)
	time.Sleep(time.Millisecond)
	Cmd(0x2e)
	time.Sleep(time.Millisecond)
	Cmd(0x2f)
	//コントラスト設定
	Cmd(0x23) //Vo voltage regulator internal resistor ratio set
	Cmd(0x81) //Electronic volume mode set
	Cmd(0x1c) //Electronic volume register set
	//表示設定
	Cmd(0xa4) //Display all point ON/OFF = normal
	Cmd(0x40) //Display start line = 0
	Cmd(0xa6) //Display normal/revers = normal
	Cmd(0xaF) //Dsiplay = ON
}

var pic = [6][128]byte{{0, 0, 0, 0, 128, 192, 192, 224, 224, 224, 224, 224, 224, 224, 224, 224, 224, 96, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 128, 224, 224, 224, 224, 224, 224, 224, 224, 192, 192, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 31, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 224, 248, 254, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 60, 126, 126, 231, 231, 199, 199, 206, 142, 140, 0, 0, 3, 63, 255, 252, 0, 0, 240, 254, 30, 62, 248, 240, 0, 0, 254, 255, 15, 0, 0, 255, 255, 255, 0, 7, 7, 7, 7, 255, 255, 255, 7, 7, 7, 7, 0, 248, 252, 254, 15, 7, 7, 7, 7, 15, 30, 28, 0, 0, 0, 255, 255, 255, 224, 224, 224, 224, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 255, 255, 255, 255, 255, 255, 255, 255, 191, 135, 128, 128, 128, 128, 128, 128, 128, 128, 0, 0, 0, 0, 7, 7, 7, 7, 7, 135, 199, 231, 247, 251, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 12, 28, 60, 56, 48, 48, 49, 57, 63, 31, 15, 0, 0, 0, 7, 63, 62, 62, 63, 7, 0, 0, 7, 63, 62, 62, 63, 7, 0, 0, 0, 63, 63, 63, 0, 0, 0, 0, 0, 63, 63, 63, 0, 0, 0, 0, 0, 3, 15, 31, 28, 56, 56, 56, 56, 28, 30, 14, 0, 0, 0, 63, 63, 63, 0, 0, 0, 0, 63, 63, 63, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 127, 31, 3, 0, 0, 128, 192, 224, 240, 248, 252, 254, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 224, 176, 24, 8, 8, 8, 8, 16, 48, 0, 0, 0, 192, 48, 16, 8, 8, 8, 24, 16, 96, 0, 0, 0, 248, 0, 0, 0, 248, 8, 8, 8, 8, 8, 8, 8, 0, 0, 0, 248, 16, 96, 192, 0, 0, 0, 0, 0, 248, 0, 0, 0, 192, 48, 16, 8, 8, 8, 24, 16, 96, 0, 0, 248, 8, 8, 8, 8, 8, 8, 8, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 239, 227, 240, 248, 252, 254, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 255, 0, 0, 0, 0, 0, 0, 0, 0, 96, 193, 129, 3, 2, 2, 6, 132, 204, 120, 0, 15, 112, 192, 128, 0, 0, 0, 0, 192, 96, 0, 0, 0, 255, 0, 0, 0, 255, 2, 2, 2, 2, 2, 2, 2, 0, 0, 0, 255, 0, 0, 0, 3, 12, 24, 96, 192, 255, 0, 0, 15, 112, 192, 128, 0, 0, 0, 0, 192, 96, 0, 0, 255, 2, 2, 2, 2, 2, 2, 2, 0, 0, 0, 0, 0, 0, 0},
	{0, 0, 0, 0, 1, 3, 3, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 7, 3, 3, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 1, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0, 0, 0, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 0, 0},
}

func ShowLogo() {
	for i := 0; i < 6; i++ {
		Cmd(0xb0 + byte(i))
		Cmd(0x10)
		Cmd(0x00)
		Data(pic[i][:])
	}
}
